% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/initial_CRC_SPIN_processed_merged_CRC_MCED.R
\name{build_crc_data_revised}
\alias{build_crc_data_revised}
\title{Build revised CRC-SPIN person-level data for a screening scenario}
\usage{
build_crc_data_revised(crc_spin_scenario, CRC_SPIN_dir)
}
\arguments{
\item{crc_spin_scenario}{Character scalar specifying the CRC-SPIN scenario name. Must be one of
\code{"control"}, \code{"colonoscopy"}, \code{"annual_fit"},
\code{"mced_annual"}, \code{"mced_biennial"}, \code{"mced_triennial"},
\code{"CRC_single_cancer_annual"}, \code{"CRC_single_cancer_biennial"},
\code{"CRC_single_cancer_triennial"},
\code{"MCED_annual_no_CRC"}, \code{"MCED_biennial_no_CRC"}, \code{"MCED_triennial_no_CRC"}.}

\item{CRC_SPIN_dir}{Path to directory containing CRC-SPIN person-level \code{.rds}
files named like \code{scr_parmID_0_blockID_0_scenarioID_<ID>_person.rds}.}
}
\value{
A data.frame containing harmonized CRC-SPIN person-level data. At minimum includes
\code{sex}, \code{p_id}, \code{start_age}, \code{other_cause_death_time}, \code{cancer_site}, and
\code{age_OC_death_cat}, plus scenario-dependent diagnosis/death/stage fields.
}
\description{
Reads CRC-SPIN person-level simulation output for a specified screening scenario
and returns a standardized dataset with harmonized variable names used in
downstream MCED/CRC merging workflows.
}
\details{
Supported scenarios include:
\itemize{
\item \code{"control"} (no screening)
\item \code{"colonoscopy"}
\item \code{"annual_fit"}
\item \code{"mced_annual"}, \code{"mced_biennial"}, \code{"mced_triennial"} (MCED including CRC;
returns screened trajectory and joins control CRC trajectory by \code{p_id})
\item \code{"CRC_single_cancer_annual"}, \code{"CRC_single_cancer_biennial"},
\code{"CRC_single_cancer_triennial"} (CRC-only MCED; implemented via CRC-SPIN scenarioIDs 4/5/6)
\item \code{"MCED_annual_no_CRC"}, \code{"MCED_biennial_no_CRC"},
\code{"MCED_triennial_no_CRC"} (MCED used for non-CRC cancers only; CRC remains control trajectory,
joined by \code{p_id})
}

Output columns depend on scenario type:
\itemize{
\item Clinical scenarios return \code{clinical_diagnosis_time},
\code{cancer_death_time_no_screen}, \code{clinical_diagnosis_stage}.
\item Screen scenarios return \code{screen_diagnosis_time},
\code{cancer_death_time_screen}, \code{screen_diagnosis_stage}, and may also include
control variables joined by \code{p_id}.
}

Sex is standardized to \code{"Male"}/\code{"Female"} using the CRC-SPIN \code{fem} indicator.
\code{cancer_site} is set to \code{"Colorectal"}. Stage is collapsed to \code{"Early"} for stages
1--2 and \code{"Late"} otherwise. Other-cause death age is binned into 5-year intervals using
\code{cut(other_cause_death_time, breaks = seq(0, 150, 5))}.
}
\examples{
\dontrun{
crc_control <- build_crc_data_revised("control", CRC_SPIN_dir = "path/to/crc_spin")
crc_fit     <- build_crc_data_revised("annual_fit", CRC_SPIN_dir = "path/to/crc_spin")

crc_list <- list(control = crc_control, annual_fit = crc_fit)
}

}
